## How Models Work

### Introduction

کار را با مروری بر نحوه عملکرد مدل‌های یادگیری ماشین و کاربرد آن‌ها شروع می‌کنیم. 

> فرض کنید پسرعموی شما از طریق خرید و فروش ملک، میلیون‌ها دلار سود کرده است. او به دلیل علاقه شما به یادگیری ماشین، پیشنهاد داده که با هم شریک شوید؛ به این صورت که او سرمایه را تأمین کند و شما مدل‌هایی بسازید که قیمت خانه‌های مختلف را پیش‌بینی کنند.

وقتی از پسرعمویتان می‌پرسید که در گذشته چطور قیمت‌ها را پیش‌بینی می‌کرده، می‌گوید که این کار فقط بر اساس «شهود» بوده است. اما با پرس‌وجوی بیشتر مشخص می‌شود که او الگوهای قیمتی را از خانه‌هایی که در گذشته دیده شناسایی کرده و از آن الگوها برای پیش‌بینی قیمت خانه‌های جدید استفاده می‌کند.

یادگیری ماشین هم دقیقاً به همین صورت عمل می‌کند. ما با مدلی به نام **درخت تصمیم (Decision Tree)** شروع خواهیم کرد. مدل‌های پیچیده‌تری هم وجود دارند که پیش‌بینی‌های دقیق‌تری ارائه می‌دهند، اما درک درخت‌های تصمیم ساده است و آن‌ها سنگ‌بنای اصلی برخی از بهترین مدل‌های علم داده محسوب می‌شوند.

برای سادگی، با ابتدایی‌ترین حالتِ ممکنِ یک درخت تصمیم کار را آغاز می‌کنیم.

![[1-1.png]]

این مدل خانه هارو تنها به 2 دسته بندی (بیشتر از 2 اتاق خواب یا کمتر از 2 اتاق خواب) تقسیم میکنه
قیمت پیش‌بینی‌شده برای هر دسته جدید، بر اساس **میانگین قیمت خانه‌های مشابه** در گذشته (که در همان گروه قرار داشتند) محاسبه می‌شود

ما از داده‌ها در دو مرحله استفاده می‌کنیم:
۱. ابتدا برای اینکه بفهمیم خانه‌ها را بر چه اساسی به دو دسته تقسیم کنیم.
۲. سپس برای اینکه قیمت میانگینِ هر گروه را به دست آوریم.

به این فرآیندِ استخراجِ الگو از داده‌ها، **«برازش» (Fitting)** یا **«آموزش مدل» (Training)** می‌گوییم. همچنین به مجموعه‌ی داده‌هایی که برای این کار استفاده می‌شوند، **«داده‌های آموزشی» (Training Data)** گفته می‌شود.

وقتی مدل شما «آموزش» دید، می‌توانید آن را روی خانه‌های جدید اجرا کنید تا قیمت آن‌ها را برایتان **پیش‌بینی (Predict)** کند.

### Improving the Decision Tree

بزرگ‌ترین نقطه ضعف این مدلِ ساده این است که عوامل کلیدی دیگر مثل تعداد سرویس‌های بهداشتی، متراژ زمین و محله را کلاً نادیده می‌گیرد.

برای اینکه بتوانیم این متغیرهای مختلف را هم در پیش‌بینی دخیل کنیم، باید از درختی استفاده کنیم که **تقسیم‌بندی‌های (Splits)** بیشتری داشته باشد. در اصطلاح به این مدل‌ها، درختهای **«عمیق‌تر» (Deeper Trees)** می‌گوییم.

مثلاً اگر بخواهیم علاوه بر تعداد اتاق، «متراژ کل زمین» را هم در مدل لحاظ کنیم، ساختار درخت ما لایه‌های بیشتری پیدا می‌کند و شبیه به این می‌شود:

![[1-2.png]]

برای پیش‌بینی قیمت هر خانه، کافی است ویژگی‌های آن را بردارید و در **درخت تصمیم** مسیر درست را دنبال کنید؛ یعنی در هر مرحله، شاخه‌ای را انتخاب کنید که با مشخصات آن خانه هم‌خوانی دارد.

قیمت نهایی پیش‌بینی‌شده در انتهای این مسیر قرار گرفته است. به این نقاطِ پایانی که دیگر تقسیمی ندارند و پیش‌بینی نهایی را به ما می‌دهند، **«برگ» (Leaf)** می‌گوییم.

اینکه درخت ما در چه نقاطی تقسیم بندی بشه (Splits) و چه اعدادی در «برگ‌ها» قرار بگیرند، تماماً توسط خودِ داده‌ها تعیین می‌شود. پس حالا وقت آن است که برویم سراغ اصل مطلب و نگاهی به داده‌هایی بیندازیم که قرار است با آن‌ها کار کنیم.

## Basic Data Exploration

### Using Pandas to Get Familiar With Your Data

در هر پروژه یادگیری ماشین، قدم اول این است که بفهمید اصلاً با چه داده‌هایی سر و کار دارید. ابزار شماره یک دانشمندان داده برای تحلیل و دستکاری داده‌ها، کتابخانه‌ی **Pandas** است. در دنیای برنامه‌نویسی، معمولاً برای سرعت بیشتر، این کتابخانه را با نام مستعار `pd` فراخوانی می‌کنند:

```python
import pandas as pd
```

قلب تپنده‌ی این کتابخانه، مفهومی به نام **DataFrame** (دیتافریم) است. دیتافریم را مثل یک جدول بزرگ تصور کنید؛ دقیقاً شبیه به یک فایل **Excel** یا جدولی در پایگاه داده **SQL** که سطر و ستون دارد.

پانداز ابزارهای بسیار قدرتمندی دارد که هر بلایی بخواهید سر این جدول‌ها بیاورید (از فیلتر کردن گرفته تا محاسبات پیچیده)، به سادگی برایتان انجام می‌دهد.

برای یادگیری، ما از داده‌های واقعیِ قیمت مسکن در **ملبورن استرالیا** استفاده می‌کنیم.
فایل داده‌های ملبورن در این مسیر قرار دارد:

`https://raw.githubusercontent.com/itsmecevi/dataset/main/melb_data.csv`

حالا وقت آن است که با چند دستور ساده، این داده‌ها را بارگذاری کرده و داخل آن‌ها را سرک بکشیم:

```python
import pandas as pd

# استفاده از لینک مستقیم داده‌ها در گیت‌هاب به جای دانلود و مسیر لوکال
melbourne_file_path = 'https://raw.githubusercontent.com/itsmecevi/dataset/main/melb_data.csv'

# خواندن داده‌ها از اینترنت و ذخیره در دیتافریم
melbourne_data = pd.read_csv(melbourne_file_path)

# نمایش خلاصه‌ای از وضعیت داده‌ها
melbourne_data.describe()
```
![[1-3.png]]

### Interpreting Data Description

وقتی آمارهای کلی جدولتان را می‌گیرید، برای هر ستون ۸ عددِ کلیدی نمایش داده می‌شود که تصویر دقیقی از وضعیت داده‌ها به شما می‌دهد:

۱. **تعداد (Count):** این عدد نشان می‌دهد در هر ستون چند خانه‌ی «پُر» داریم. گاهی اوقات داده‌ها **Missing** یا «گم‌شده» هستند؛ مثلاً وقتی دارید اطلاعات یک خانه‌ی یک‌خوابه را ثبت می‌کنید، طبیعی است که ستونِ «متراژ اتاق دوم» خالی بماند. (در آینده یاد می‌گیریم چطور با این خانه‌های خالی برخورد کنیم).

۲. **میانگین (Mean):** همان معدلِ اعدادِ آن ستون است.

۳. **انحراف معیار (Std):** این شاخص نشان می‌دهد که اعداد چقدر از میانگین فاصله دارند و چقدر پراکنده‌اند. (آیا قیمت‌ها همه نزدیک به هم هستند یا تفاوت‌های فاحش دارند؟)
اگه نزدیک به صفر باشه یعنی داده به هم نزدیکن
اگه نزدیک به میانگین باشه یعنی داده های توی یه بازه پراکنده پخش شدن و تفاوت فاحش دارند

۴. **درک بازه‌های قیمتی (چارک‌ها):**

برای درک مقادیر **Min**، **25%**، **50%**، **75%** و **Max**، تصور کنید تمام خانه‌ها را بر اساس قیمت، از ارزان‌ترین تا گران‌ترین پشت سر هم ردیف کرده‌اید:

- **مین (Min):** قیمت ارزان‌ترین خانه در لیست است.
- **25% (صدک ۲۵ام):** عددی است که از ۲۵ درصدِ خانه‌ها گران‌تر و از ۷۵ درصدِ بقیه ارزان‌تر است.
- **50% (میانه):** دقیقاً خانه‌ای که وسط صف ایستاده است! نیمی از خانه‌ها از این قیمت ارزان‌تر و نیمی دیگر گران‌تر هستند.
- **75% (صدک ۷۵ام):** عددی است که از ۷۵ درصدِ خانه‌ها گران‌تر است.
- **مکس(Max)** قیمت گران‌ترین خانه‌ی موجود در داده‌ها است.

### Exercises

حالا وقتشه خودتون تمرین کنید که یاد بگیرید
باید این مراحلی که تا اینجا انجام دادیم رو توی یه دیتاست دیگه انجام بدید